# 「別ウィンドウで開く」フロントエンドで反映されない不具合の修正

## チケットへのリンク / 変更の理由（元のissueがあればリンクを貼り付ければOK）

（ 既存の不具合修正。Issue #99 のテスト中に発見 ）

## どういう変更をしたか？

* 「別ウィンドウで開く」にチェックしてもフロントエンドでリンクが別タブで開かない不具合を修正した
  * `ajax_rewrite_ids` のデータ構造を配列からオブジェクト形式（`re`, `pl`, `tg`）に変更し、`array_unique` によるデータ破損を防止
  * URL の構築を `rewrite_link()` に統一し、内部リンクのマッチングを正確に
  * JavaScript 側でリダイレクトURL とパーマリンクの両方でマッチを試行するよう変更（テーマによって出力が異なるため）
  * JSON レスポンスのパース処理を追加

## レビューに回す前に確認する事

- [ ] 複数の意図の変更 （ 機能の不具合修正 + 別の機能追加など ） を含んでいないか？
- [ ] Files changed (変更ファイル)の内容は目視で確認したか？
- [ ] readme.txt に変更内容は書いたか？
- [ ] 本当にちゃんと確認をしたか？

## プログラムの変更の場合

- [ ] 書けそうなテストは書いたか？


## 変更内容について何を確認したか、どういう方法で確認をしたかなど

* リダイレクト用URL を設定し「別ウィンドウで開く」にチェックして投稿を保存
* フロントエンドの一覧ページでリンクをクリックした際に別タブで開くことを確認

## 確認URL

（ ローカル環境で確認可 ）


## レビュワーの確認方法・確認する内容など

1. リダイレクト用URL を設定し「別ウィンドウで開く」にチェック
2. 投稿を保存
3. フロントエンドの一覧でリンクをクリックした際に別タブで開くこと

## レビュワーに回す前の確認事項

- [ ] このテンプレートのチェック項目をちゃんと確認してチェックしたか？

---

## レビュワー向け

### 確認して変更が反映されていない場合の確認事項

* プルしたか？
* ビルドしたか？（`npm run jsmin` で script.min.js を生成）
* ビルドしたディレクトリは正しいか（別の開発環境のディレクトリを見ていないか）？
* npm install したか？
* composer install したか？
